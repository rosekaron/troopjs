<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @license MIT http://troopjs.mit-license.org/
 */
define([
	&quot;../component/widget&quot;,
	&quot;./runner/sequence&quot;,
	&quot;when&quot;
], function RouteWidgetModule(Widget, sequence, when) {
	&quot;use strict&quot;;

	var UNDEFINED;
	var NULL = null;
	var ARRAY_PROTO = Array.prototype;
	var ARRAY_PUSH = ARRAY_PROTO.push;
	var LENGTH = &quot;length&quot;;
	var ROUTE = &quot;route&quot;;
	var NAME = &quot;name&quot;;
	var TYPE = &quot;type&quot;;
	var VALUE = &quot;value&quot;;
	var FEATURES = &quot;features&quot;;
	var RUNNER = &quot;runner&quot;;
	var RE = new RegExp(&quot;^&quot; + ROUTE + &quot;/(.+)&quot;);

	return Widget.extend({

		&quot;sig/initialize&quot;: function onInitialize() {
			var me = this;

			return when.map(me.constructor.specials[ROUTE] || ARRAY_PROTO, function (special) {
				return me.on(special[NAME], special[VALUE], special[FEATURES]);
			});
		},

		&quot;sig/add&quot;: function onAdd(handlers, type, callback, data) {
			var me = this;
			var matches;
			var result;

			if ((matches = RE.exec(type)) !== NULL) {
				result = false;
				me.on(ROUTE, callback, matches[1]);
			}

			return result;
		},

		&quot;hub/route&quot;: function onRoute(routeId, route) {
			var me = this;
			var args = {};
			args[TYPE] = ROUTE;
			args[RUNNER] = sequence;
			args = [ args ];

			// Push original arguments on args
			ARRAY_PUSH.apply(args, arguments);

			return me.emit.apply(me, args);
		},


		&quot;route&quot;: function route(routeId, route) {
			// Shift arguments if no route was provided
			if (arguments[LENGTH] === 1) {
				route = routeId;
				routeId = UNDEFINED;
			}

			return this.publish(&quot;hub/&quot; + ROUTE + &quot;/change&quot;, routeId, route);
		}
	});
});</pre>
</body>
</html>
