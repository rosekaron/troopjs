<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*
 * TroopJS jquery/dimensions
 * @license MIT http://troopjs.mit-license.org/ Â© Mikael Karon mailto:mikael@karon.se
 */
define([ &quot;jquery&quot;, &quot;./resize&quot; ], function DimensionsModule($) {
	&quot;use strict&quot;;

	var NULL = null;
	var DIMENSIONS = &quot;dimensions&quot;;
	var RESIZE = &quot;resize.&quot; + DIMENSIONS;
	var W = &quot;w&quot;;
	var H = &quot;h&quot;;
	var _W = &quot;_&quot; + W;
	var _H = &quot;_&quot; + H;

	/*
	 * Internal comparator used for reverse sorting arrays
	 */
	function reverse(a, b) {
		return b - a;
	}

	/*
	 * Internal onResize handler
	 */
	function onResize() {
		/*jshint validthis:true*/
		var me = this;
		var $me = $(me);
		var width = $me.width();
		var height = $me.height();

		// Iterate all dimensions
		$.each($.data(me, DIMENSIONS), function dimensionIterator(namespace, dimension) {
			var w = dimension[W];
			var h = dimension[H];
			var _w;
			var _h;
			var i;

			i = w.length;
			_w = w[i - 1];
			while(w[--i] &lt; width) {
				_w = w[i];
			}

			i = h.length;
			_h = h[i - 1];
			while(h[--i] &lt; height) {
				_h = h[i];
			}

			// If _w or _h has changed, update and trigger
			if (_w !== dimension[_W] || _h !== dimension[_H]) {
				dimension[_W] = _w;
				dimension[_H] = _h;

				$me.trigger(DIMENSIONS + &quot;.&quot; + namespace, [ _w, _h ]);
			}
		});
	}

<span id='$-event-dimensions'>	/**
</span>	 * jQuery event fired ever since the element size meets the specified dimension.
	 * @member $
	 * @event dimensions
	 */
	$.event.special[DIMENSIONS] = {
		setup : function onDimensionsSetup() {
			$(this)
				.bind(RESIZE, onResize)
				.data(DIMENSIONS, {});
		},

		/*
		 * Do something each time an event handler is bound to a particular element
		 * @param handleObj (Object)
		 */
		add : function onDimensionsAdd(handleObj) {
			var me = this;
			var namespace = handleObj.namespace;
			var dimension = {};
			var w = dimension[W] = [];
			var h = dimension[H] = [];
			var re = /(w|h)(\d+)/g;
			var matches;

			while ((matches = re.exec(namespace)) !== NULL) {
				dimension[matches[1]].push(parseInt(matches[2], 10));
			}

			w.sort(reverse);
			h.sort(reverse);

			$.data(me, DIMENSIONS)[namespace] = dimension;
		},

		/*
		 * Do something each time an event handler is unbound from a particular element
		 * @param handleObj (Object)
		 */
		remove : function onDimensionsRemove(handleObj) {
			delete $.data(this, DIMENSIONS)[handleObj.namespace];
		},

		teardown : function onDimensionsTeardown() {
			$(this)
				.removeData(DIMENSIONS)
				.unbind(RESIZE, onResize);
		}
	};
});</pre>
</body>
</html>
