<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*
 * TroopJS core/registry/service
 * @license MIT http://troopjs.mit-license.org/ Â© Mikael Karon mailto:mikael@karon.se
 */
define([ &quot;../component/service&quot;, &quot;poly/object&quot;, &quot;poly/array&quot; ], function RegistryServiceModule(Service) {
	&quot;use strict&quot;;

<span id='core-registry-service'>	/**
</span>	 * A special {@link core.component.service service} presents the registry table for all
	 * other services across the application.
	 *
	 * 	// Upon instantiation this service is registered.
	 * 	Service.create({
	 *
	 * 		// This will be the service key.
	 * 		displayName: &quot;my/provided&quot;,
	 *
	 * 		// Provide actual services on hub.
	 * 		&quot;hub/my/provided/service&quot; : function() {
	 * 			// Do some dirty lift.
	 * 		}
	 * 	});
	 *
	 * 	// Now we can look for it in registry.
	 * 	var service = registry.get(&quot;my/provided&quot;)[0];
	 *
	 * @class core.registry.service
	 * @extends core.component.service
	 */

	var SERVICES = &quot;services&quot;;

	return Service.extend(function RegistryService() {
		var me = this;

		me[SERVICES] = {};

		me.add(me);
	},{
		&quot;displayName&quot; : &quot;core/registry/service&quot;,

<span id='core-registry-service-method-add'>		/**
</span>		 * Register a service.
		 * @param {core.component.service} service
		 */
		&quot;add&quot; : function add(service) {
			this[SERVICES][service.toString()] = service;
		},

<span id='core-registry-service-method-remove'>		/**
</span>		 * Remove a service from the registry.
		 * @param {core.component.service} service
		 */
		&quot;remove&quot;: function remove(service) {
			delete this[SERVICES][service.toString()];
		},

<span id='core-registry-service-method-get'>		/**
</span>		 * Find registered service(s) by service name.
		 * @param {String} pattern Regexp that matches the service name.
		 * @returns {Array|null}
		 */
		&quot;get&quot; : function get(pattern) {
			var re = new RegExp(pattern);
			var services = this[SERVICES];

			return Object.keys(services)
				.filter(function filter(serviceName) {
					return re.test(serviceName);
				})
				.map(function map(serviceName) {
					return services[serviceName];
				});
		},

<span id='core-registry-service-event-hub/registry/add'>		/**
</span>		 * Hub event for adding service.
		 * @event
		 * @param {core.component.service} service
		 * @returns {*}
		 */
		&quot;hub/registry/add&quot; : function onAdd(service) {
			return this.add(service);
		},

<span id='core-registry-service-event-hub/registry/remove'>		/**
</span>		 * Hub event for removing service.
		 * @event
		 * @param {core.component.service} service
		 * @returns {*}
		 */
		&quot;hub/registry/remove&quot; : function onRemove(service) {
			return this.remove(service);
		},

<span id='core-registry-service-event-hub/registry/get'>		/**
</span>		 * Hub event for finding service(s).
		 * @event
		 * @param {String} pattern
		 * @returns {*}
		 */
		&quot;hub/registry/get&quot; : function onGet(pattern) {
			return this.get(pattern);
		}
	});
});</pre>
</body>
</html>
